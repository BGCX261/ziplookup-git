/*
 * $.zipLookup v0.1
 *   - by Ari Asulin (ari.asulin at gmail.com)
 *   - jQuery plugin to dynamically fill in City/State Form Fields using an ajax Zipcode lookup
 *   - Apache License, Version 2.0
 *
 */
(function(a){a.extend({zipLookupSetup:function(a){jQuery.extend(jQuery.ajaxSettings,a)},zipLookupSettings:{zipField:null,cityField:null,stateField:null,libDirPath:null,dbPath:"db/",country:"us",onFound:function(){},onNotFound:function(){},onError:function(){}},zipLookup:function(b,c,d){if(c instanceof Function){c={onFound:c}}c=jQuery.extend(true,{},jQuery.zipLookupSettings,c);if(d instanceof Function)c.onNotFound=d;if(c.libDirPath==null){var e=a("script[src*='zipLookup.js'],script[src*='zipLookup.min.js']").attr("src");if(e){c.libDirPath=e.replace("zipLookup.js","").replace("zipLookup.min.js","")}else c.libDirPath="ziplookup/"}if(!parseInt(b))return c.onNotFound("Invalid zip code: "+b);b=parseInt(b);var f=parseInt(b/100);var g=parseInt(b%100);var h=c.libDirPath+c.dbPath+c.country+"/"+f+".jsonp";a.ajax({url:h,dataType:"jsonp",jsonpCallback:"__zl",cache:true,success:function(a){if(a===undefined||a[0]===undefined)return c.onNotFound("Zipcode Not Found in DB");var b=a[0][g];if(a[1][b]===undefined)return c.onNotFound("Zipcode Not Found in DB");var d=a[1][b].split("|");var e=d[0];if(!d[1])d[1]=0;var f=d[1];var h=a[2][f].split("|");var i=h[1];var j=h[0];c.onFound(e,i,j)},fail:function(a,b){c.onError(a,b);c.onNotFound("Error: "+b)}})}})})(jQuery)